<style>
span {
  margin-right: 10px;
}
.p0, .p1 {
  display: none;
}
</style>

<span class='x p2'>xx</span><span class='x p1'>x</span>

<script>
$ = s => document.querySelector(s);
n = 40;
n = 4_000;
// n = 4_000_000;
for(;next =
  (next => {
    next.classList.add('x', 'p'+(+Array.from($('.x').classList).filter(x=>x!=='x').map(x => x[1])+1)%3);
    next.innerText = $('.x').innerText + $('.x:not(:first-child)').innerText;
    if (next.innerText.length <= n) return next
  })(document.createElement('span'))
;) document.body.prepend(next);
console.log(document.body.innerText.length);
</script>
