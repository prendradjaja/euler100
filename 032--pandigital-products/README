TODO: This takes about 13 seconds. I should be able to make it faster!
